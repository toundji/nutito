"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fetchConnection = void 0;
const typeorm_1 = require("typeorm");
const ConnectionConfigurationManager_1 = require("./ConnectionConfigurationManager");
const getConnectionOptions_1 = require("./getConnectionOptions");
const fetchConnection = async () => {
    const { connection: connectionName } = ConnectionConfigurationManager_1.ConnectionConfigurationManager.getInstance().configuration;
    const getNewConnection = async () => (0, typeorm_1.createConnection)(await (0, getConnectionOptions_1.getConnectionOptions)());
    let connection;
    try {
        connection = (0, typeorm_1.getConnection)(connectionName);
        if (connection.isConnected)
            return connection;
        return getNewConnection();
    }
    catch {
        return getNewConnection();
    }
};
exports.fetchConnection = fetchConnection;
//# sourceMappingURL=fetchConnection.js.map